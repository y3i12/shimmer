======================================================================
SHIMMER MODEL EVALUATION
======================================================================

Loading checkpoint: checkpoints/lira_50m_progressive_final.pt

Model Type: LIRA
Model Config:
  Hidden size: 512
  Layers: 10
  Heads: 8
  Vocab size: 9995
  Mask token ID: 4
  Parameters: 42,359,808
Tokenizer loaded: vocab_size=9995 from tokenizers/shimmer_tinystories_9995.model
  Tokenizer: custom (vocab=9995)

======================================================================
TEST 1: Basic Generation Quality
======================================================================

Prompt: 'Once upon a time'
--------------------------------------------------
  [T=0.7] Once upon a time, there was a little girl named Lily. She loved to play with her toys and laugh with her friends. One day, Lily's mom asked her to hel...
           (iters=51)
  [T=0.9] Once upon a time, there was a little girl named Lily. She loved to play outside and explore the world around her. One day, Lily's mom asked her to hel...
           (iters=51)

Prompt: 'There was a little girl named'
--------------------------------------------------
  [T=0.7] There was a little girl named Lucy. She was three years old. ⁇ One day, Lucy decided to go on an adventure. She wanted to explore the world around her...
           (iters=51)
  [T=0.9] There was a little girl named Lily. Lily was very obedient and always listened to her mom said. ⁇ One day, Lily's mom asked her to help her in the kit...
           (iters=51)

Prompt: 'The sun was shining and'
--------------------------------------------------
  [T=0.7] The sun was shining and the birds were singing. ⁇ Suddenly, a loud noise came from the sky. It was a big, loud noise. The noise was very loud and scar...
           (iters=51)
  [T=0.9] The sun was shining and the birds were singing. ⁇ One day, a little boy went to the park. He saw a big slide and wanted to go on it. He asked his mom ...
           (iters=51)

Prompt: 'One day, a small cat'
--------------------------------------------------
  [T=0.7] One day, a small cat and the cat were playing near the tree. The cat said, "I want to sit on the tree too." The cat said, "No, I want to sit on the tr...
           (iters=51)
  [T=0.9] One day, a small cat came to the house. The cat saw the cat and said, "Hello, cat. Do you want to play with me?" The cat said, "Yes, I want to play wi...
           (iters=51)


======================================================================
TEST 2: Repetition Analysis
======================================================================

  Avg consecutive repetitions: 0.00
  Avg bigram repetition rate: 7.70%
  Avg trigram repetition rate: 2.68%

======================================================================
TEST 3: Confidence Head Analysis
======================================================================

  Mean confidence (all): 0.2592
  Mean confidence (filled tokens): 0.8237
  Mean confidence (masked tokens): 0.1111
  Confidence gap (filled - masked): 0.7126
  [GOOD] Model distinguishes filled from masked positions

======================================================================
TEST 4: Logical Coherence
======================================================================

  Loading semantic model: all-MiniLM-L6-v2...
  Combined Coherence: 100.0%
    - Keyword match:  60.0%
    - Semantic match: 100.0%
  (Multi-token generation + semantic similarity)

  [✓ PASS] 'The cat was hungry so it...'
           Generated: "went to look for food. it found a bush..."
           Matched: keywords: ['food'], semantic flow: 0.76
  [✓ PASS] 'It was raining outside so they stayed...'
           Generated: "inside and played in the yard. they had so..."
           Matched: keywords: ['inside'], semantic flow: 0.83
  [✓ PASS] 'The sun set and the sky turned...'
           Generated: "into into a beautiful sunset. the sunset smiled and..."
           Matched: semantic topics: ['night']
  [✓ PASS] 'The little girl was happy because she got a new...'
           Generated: "friend.  ⁇ the little girl and the girl..."
           Matched: keywords: ['friend'], semantic flow: 0.78
  [✓ PASS] 'The dog ran fast and caught the...'
           Generated: "dog. the dog was happy and thanked the dog..."
           Matched: semantic topics: ['toy']

======================================================================
TEST 5: Generation Methods Comparison
======================================================================


Method: topk
----------------------------------------
  Once upon a time, there was a little girl named Lily. She loved to play with her toys and sing songs. One day, Lily's mo...
  Once upon a time, there was a little girl named Lily. She loved to play outside and explore the world around her. One da...
  Once upon a time, there was a little girl named Lily. She loved to play outside and explore the world around her. One da...

Method: remasking
----------------------------------------
  Once upon a time, there was a little cat named Max. Spot loved to play with and toys and.... day day,,,,,,,................
  Once upon a time, there was a little cat named Max. Spot loved to play with and toys and.... day day,,,,,,,................
  Once upon a time, there was a little girl named Lily. She loved to play with and and.... day day day,,,,,,,,...............

======================================================================
TEST 6: Challenge Prompts
======================================================================

Prompt: 'Once upon a time, there was a little girl who love...'
Output: Once upon a time, there was a little girl who loved to play in the garden. One sunny day, she saw a butterfly flying around the flowers. She tried to catch it, but it was too fast. The butterfly flew away and the little girl felt sad

Prompt: 'The little boy was very sad because...'
Output: The little boy was very sad because his family didn't have his toys anymore.  ⁇ His mom saw him crying and asked him what was wrong. The little boy told her mom

Prompt: 'The brave knight drew his sword and...'
Output: The brave knight drew his sword and his shield. He admired his shield and his sword. He was proud and happy. ⁇ He went to play with his toys and his shield. He

Prompt: '"Hello!" said the rabbit. The bear replied...'
Output: "Hello!" said the rabbit. The bear replied, "It's nice to meet you, little rabbit!" ⁇ The rabbit said, "It's nice to meet you, Mr. Bear


======================================================================
TEST 7: Perplexity (TinyStories Validation)
======================================================================

  Perplexity: 1.64
  Avg Loss: 0.4963
  Masked tokens evaluated: 4,956
  (Mask ratio: 30%)
  [GOOD] Low perplexity indicates good language modeling

======================================================================
TEST 8: Generation Diversity
======================================================================

  Word diversity:   41.7%
  Bigram diversity: 65.9%
  Trigram diversity: 75.7%
  Self-similarity:  0.0%
  [OK] Moderate diversity

======================================================================
TEST 9: Length Stress Test
======================================================================

  [✓]  50 tokens: 200.3 tok/s, end_div=0.90, rep=0.05
  [✓] 100 tokens: 198.6 tok/s, end_div=1.00, rep=0.03
  [✓] 200 tokens: 189.0 tok/s, end_div=1.00, rep=0.35

  [GOOD] Quality maintained across lengths

======================================================================
EVALUATION SUMMARY
======================================================================

Model: 42,359,808 parameters
Coherence Rate: 100.0%
Confidence Gap: 0.7126
Bigram Repetition: 7.7%
Perplexity: 1.64
Diversity: 65.9%

Overall Quality: EXCELLENT (3/3)

======================================================================
Evaluation complete!
======================================================================