======================================================================
SHIMMER MODEL EVALUATION
======================================================================

Loading checkpoint: checkpoints/shimmer_v1_29M1_384_12_12_10235V_phase_4_train_3_epoch.pt

Model Config:
  Hidden size: 384
  Layers: 12
  Heads: 12
  Vocab size: 10235
  Mask token ID: 4
  Parameters: 29,104,896
Tokenizer loaded: vocab_size=10235 from tokenizers/shimmer_10235.model
  Tokenizer: custom (vocab=10235)

======================================================================
TEST 1: Basic Generation Quality
======================================================================

Prompt: 'Once upon a time'
--------------------------------------------------
  [T=0.7] Once upon a time, there was a little girl named Lily. She loved to play outside in the park with her friends. One day, Lily and her friends decided to...
           (iters=51)
  [T=0.9] Once upon a time, there was a little girl named Lily. She loved to play outside in the park with her friends. One day, Lily's friend came over to play...
           (iters=51)

Prompt: 'There was a little girl named'
--------------------------------------------------
  [T=0.7] There was a little girl named Lucy. She was three years old and she loved to explore. One day, she went for a walk in the woods. As she was walking, s...
           (iters=51)
  [T=0.9] There was a little girl named Lucy. She was three years old and loved to play with her toys. One day, she was playing with her dolls when she accident...
           (iters=51)

Prompt: 'The sun was shining and'
--------------------------------------------------
  [T=0.7] The sun was shining and the birds were singing. ⁇ The sun was shining and the sky was blue. The birds were singing and the birds were singing. ⁇ Sudde...
           (iters=51)
  [T=0.9] The sun was shining and the sky. It was warm and the sky was blue. ⁇ The sun started to rise and the sun began to rise. It was warm and warm and the s...
           (iters=51)

Prompt: 'One day, a small cat'
--------------------------------------------------
  [T=0.7] One day, a small cat named Tom was playing in the yard. He saw a big ball on the ground. Tom thought it would be fun to play with the ball. He picked ...
           (iters=51)
  [T=0.9] One day, a small cat was playing in the yard. The cat saw a big, red apple on the ground. The cat wanted to eat the apple, but it was too high. The ca...
           (iters=51)


======================================================================
TEST 2: Repetition Analysis
======================================================================

  Avg consecutive repetitions: 0.00
  Avg bigram repetition rate: 14.65%
  Avg trigram repetition rate: 8.18%

======================================================================
TEST 3: Confidence Head Analysis
======================================================================

  Mean confidence (all): 0.2619
  Mean confidence (filled tokens): 0.7861
  Mean confidence (masked tokens): 0.1243
  Confidence gap (filled - masked): 0.6617
  [GOOD] Model distinguishes filled from masked positions

======================================================================
TEST 4: Logical Coherence
======================================================================

  Loading semantic model: all-MiniLM-L6-v2...
  Combined Coherence: 100.0%
    - Keyword match:  40.0%
    - Semantic match: 100.0%
  (Multi-token generation + semantic similarity)

  [✓ PASS] 'The cat was hungry so it...'
           Generated: "decided to find some food.  ⁇ the cat..."
           Matched: keywords: ['food'], semantic flow: 0.89
  [✓ PASS] 'It was raining outside so they stayed...'
           Generated: "in the grass and watched as the rain still...."
           Matched: semantic topics: ['dry', 'indoors', 'inside']
  [✓ PASS] 'The sun set and the sky turned...'
           Generated: "green. the sun was warm and the birds were..."
           Matched: semantic topics: ['colors', 'red', 'pink']
  [✓ PASS] 'The little girl was happy because she got a new...'
           Generated: "friend. she gave him a big hug and said..."
           Matched: keywords: ['friend'], semantic flow: 0.78
  [✓ PASS] 'The dog ran fast and caught the...'
           Generated: "dog. the dog was black and white. it..."
           Matched: semantic topics: ['toy', 'frisbee', 'ball']

======================================================================
TEST 5: Generation Methods Comparison
======================================================================


Method: topk
----------------------------------------
  Once upon a time, there was a little girl named Lily. She loved to play outside in the park with her friends. One day, L...
  Once upon a time, there was a little girl named Lily. She loved to play outside in the park with her friends. One day, L...
  Once upon a time, there was a little girl named Lily. She loved to play outside in the sunshine with her friends. One da...

Method: remasking
----------------------------------------
  Once upon a time, there was a little girl named Lily. She loved to play outside her her and her....,,,, her her her her....
  Once upon a time, there was a little girl named Lily. She loved to play outside her her and her....,,,, her her her her....
  Once upon a time, there was a little girl named Lily. She loved to play outside her her and her....,,,, her her her her....

======================================================================
TEST 6: Challenge Prompts
======================================================================

Prompt: 'Once upon a time, there was a little girl who love...'
Output: Once upon a time, there was a little girl who loved to play in the garden. One sunny day, she decided to go outside and play in the garden. She ran to the garden and went into the garden. As she was playing, she heard a voice

Prompt: 'The little boy was very sad because...'
Output: The little boy was very sad because he couldn't play with his friends. He wanted to go outside, but his mom said it was too dangerous and he had to stay inside.

Prompt: 'The brave knight drew his sword and...'
Output: The brave knight drew his sword and a shield. He said, "I am the king of the forest. You are the best knight and the bravest knight. I am the king of

Prompt: '"Hello!" said the rabbit. The bear replied...'
Output: "Hello!" said the rabbit. The bear replied, "What's your name?" The rabbit said, "I'm here to introduce you to my."  ⁇ The bear said, "


======================================================================
TEST 7: Perplexity (TinyStories Validation)
======================================================================

  Perplexity: 1.94
  Avg Loss: 0.6634
  Masked tokens evaluated: 4,976
  (Mask ratio: 30%)
  [GOOD] Low perplexity indicates good language modeling

======================================================================
TEST 8: Generation Diversity
======================================================================

  Word diversity:   39.1%
  Bigram diversity: 64.5%
  Trigram diversity: 73.8%
  Self-similarity:  0.0%
  [OK] Moderate diversity

======================================================================
TEST 9: Length Stress Test
======================================================================

  [✓]  50 tokens:  37.2 tok/s, end_div=1.00, rep=0.02
  [✓] 100 tokens:  36.7 tok/s, end_div=1.00, rep=0.20
  [✓] 200 tokens:  34.5 tok/s, end_div=0.90, rep=0.26

  [GOOD] Quality maintained across lengths

======================================================================
EVALUATION SUMMARY
======================================================================

Model: 29,104,896 parameters
Coherence Rate: 100.0%
Confidence Gap: 0.6617
Bigram Repetition: 14.7%
Perplexity: 1.94
Diversity: 64.5%

Overall Quality: EXCELLENT (3/3)

Results saved to: eval_results.json

======================================================================
Evaluation complete!
======================================================================